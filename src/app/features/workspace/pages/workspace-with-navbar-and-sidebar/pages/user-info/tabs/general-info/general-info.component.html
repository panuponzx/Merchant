<div class="general-info-container">
  <h2 class="mb-3">ข้อมูลทั่วไป</h2>
  <form [formGroup]="form" (ngSubmit)="onUpdate()">
    <div class="row g-5">
      <div class="col-12 col-sm-4">
        <h3 class="mb-3">รายละเอียดผู้ใช้งาน</h3>
        <div class="general-info-wrapper">

          <div class="user-image-wrapper">
            <img src="assets/images/icons/user_image.svg" alt="User Image">
          </div>

          <div class="upload-image-wrapper">
            <button
              class="custom-btn btn-type-3"
              data-testid="uploadImageButton"
              id="uploadImageButton"
              title="อัพโหลด"
              (click)="onUpload()"
            >
              <icon-svg
                [color]="'#2255CE'"
                [size]="'m'"
                [path]="'assets/images/icons/upload.svg'"
              />
              Browse - Upload
            </button>
          </div>

          <h3 class="mb-3">ข้อมูลการรับใบกำกับภาษีแบบอัตโนมัติ</h3>

          <div class="form-group">
            <label class="label-input" for="emailInput">
              อีเมลที่ต้องการรับใบกำกับภาษี
            </label>
            <input
              class="form-control"
              data-testid="emailInput"
              formControlName="email"
              id="emailInput"
              type="text"
              [readonly]="true"
            >
          </div>

          <div class="form-group">
            <button
              class="custom-btn btn-type-4"
              data-testid="changeEmailButton"
              id="changeEmailButton"
              title="เพิ่ม / เปลี่ยน อีเมลรับใบกำกับภาษี"
              (click)="onChangeEmail()"
            >
              เพิ่ม / เปลี่ยน อีเมลรับใบกำกับภาษี
            </button>
          </div>

          <div class="form-group">
            <label class="label-input required-field" for="autoSelect">
              การรับเอกสารใบกำกับภาษีอัตโนมัติ
            </label>
            <ng-select
              class="form-control"
              [clearable]="false"
              data-testid="autoSelect"
              id="autoSelect"
              [items]="settingEmailList"
              [searchable]="false"
              [readonly]="!form.controls['email'].value"
          ></ng-select>
          </div>

        </div>
      </div>
      <div class="col-12 col-sm-4">
        <h3 class="mb-3">ข้อมูลตามบัตรประชาชน</h3>
        <div class="general-info-wrapper">
          <ng-container [ngSwitch]="customerTypeId">
            <ng-container *ngSwitchCase="'1'">

              <div class="form-group">
                <label class="label-input" for="identificationInput">
                  หมายเลขบัตรประชาชน
                </label>
                <input
                  idCard
                  class="form-control"
                  data-testid="identificationInput"
                  formControlName="citizenId"
                  id="identificationInput"
                  type="text"
                >
              </div>

              <div class="form-group">
                <label
                  class="label-input"
                  for="expiredDateDatePicker"
                >
                  วันหมดอายุบัตร (วัน/เดือน/ปี)
                </label>
                <date-picker
                  class="datepicker-input"
                  [clearable]="false"
                  format="D MMMM YYYY"
                  formControlName="cardExpDate"
                  [id]="'expiredDateDatePicker'"
                  [invalid]="submitted && form.controls['cardExpDate'].errors ? true : false"
                  locale="th"
                  [placeholder]="'วันที่ เดือน ปี'"
                  [placement]="'bottom'"
                  [minDate]="minDate"
                ></date-picker>
              </div>

            </ng-container>
            <ng-container *ngSwitchCase="'2'">

              <div class="form-group">
                <label class="label-input" for="identificationInput">
                  หมายเลขหนังสือเดินทาง
                </label>
                <input
                  class="form-control"
                  data-testid="identificationInput"
                  formControlName="citizenId"
                  id="identificationInput"
                  type="text"
                >
              </div>

              <div class="form-group">
                <label
                  class="label-input"
                  for="expiredDateDatePicker"
                >
                  วันหมดอายุหนังสือเดินทาง (วัน/เดือน/ปี)
                </label>
                <date-picker
                  class="datepicker-input"
                  [clearable]="false"
                  format="D MMMM YYYY"
                  formControlName="cardExpDate"
                  [id]="'expiredDateDatePicker'"
                  [invalid]="submitted && form.controls['cardExpDate'].errors ? true : false"
                  locale="th"
                  [placeholder]="'วันที่ เดือน ปี'"
                  [placement]="'bottom'"
                  [minDate]="minDate"
                ></date-picker>
              </div>

            </ng-container>
          </ng-container>

          <div class="form-group">
            <div class="gender-selector">
              <div class="gender-wrapper">
                <input
                  type="radio"
                  formControlName="gender"
                  id="male"
                  value="M"
                >
                <label for="male">ชาย</label>
              </div>
              <div class="gender-wrapper">
                <input
                  type="radio"
                  formControlName="gender"
                  id="female"
                  value="F"
                >
                <label for="female">หญิง</label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label
              class="label-input"
              for="firstNameInput"
            >
              ชื่อ
            </label>
            <input
              class="form-control"
              data-testid="firstNameInput"
              formControlName="firstName"
              id="firstNameInput"
              placeholder="ชื่อ"
              type="text"
            >
          </div>

          <div class="form-group">
            <label
              class="label-input"
              for="lastNameInput"
            >
              นามสกุล
            </label>
            <input
              class="form-control"
              data-testid="lastNameInput"
              formControlName="lastName"
              id="lastNameInput"
              placeholder="ชื่อ"
              type="text"
            >
          </div>

          <div class="form-group">
            <label
              class="label-input"
              for="birthDateDatePicker"
            >
              วันเกิด (วัน/เดือน/ปี)
            </label>
            <date-picker
              class="datepicker-input"
              [clearable]="false"
              format="D MMMM YYYY"
              formControlName="birthdate"
              [id]="'birthDateDatePicke'"
              [invalid]="submitted && form.controls['birthdate'].errors ? true : false"
              locale="th"
              [placeholder]="'วันที่ เดือน ปี'"
              [placement]="'bottom'"
            ></date-picker>
          </div>

          <div class="form-group">
            <label
              class="label-input"
              for="phoneInput"
            >
              เบอร์ติดต่อ
            </label>
            <input
              class="form-control"
              data-testid="phoneInput"
              formControlName="mobilePhone"
              id="phoneInput"
              placeholder="XXX XXX XXXX"
              type="text"
            >
          </div>

        </div>
      </div>
      <div class="col-12 col-sm-4">
        <h3 class="mb-3">ข้อมูลที่อยู่</h3>
        <div class="general-info-wrapper">
          <div class="navs-container">
            <ul
              ngbNav
              #nav="ngbNav"
              [(activeId)]="activeTab"
              class="nav-tabs mb-3"
            >
              <li [ngbNavItem]="'address-on-the-card'">
                <button ngbNavLink>ที่อยู่ตามบัตร</button>
                <ng-template ngbNavContent>
                  <address
                    [form]="form.controls['registration_address'] | formControlToFormGroup"
                    [submitted]="submitted"
                  ></address>
                </ng-template>
              </li>
              <li [ngbNavItem]="'current-address'">
                <button ngbNavLink>ที่อยู่ปัจจุบัน</button>
                <ng-template ngbNavContent>
                  <address
                    [form]="form.controls['current_address'] | formControlToFormGroup"
                    [submitted]="submitted"
                  ></address>
                </ng-template>
              </li>
            </ul>
            <div [ngbNavOutlet]="nav" class="navs-content-container"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="form-button general-info-button-wrapper">
      <button
        class="custom-btn btn-fixed-size-1 btn-type-3"
        data-testid="cancelButton"
        id="cancelButton"
        title="แก้ไข"
        [disabled]="!isUpdated"
        (click)="onCancel()"
      >
        ยกเลิก
      </button>
      <button
        class="custom-btn btn-fixed-size-1 btn-type-1"
        data-testid="editButton"
        id="editButton"
        title="แก้ไข"
        [disabled]="!isUpdated"
        (click)="onUpdate()"
      >
        แก้ไข
      </button>
    </div>
  </form>
</div>


